
// Source: https://github.com/isaacdarcilla/philippine-addresses
// Switched to raw content to prevent HTML 404 responses
const BASE_URL = 'https://raw.githubusercontent.com/isaacdarcilla/philippine-addresses/master';

export interface LocationOption {
  code: string;
  name: string;
}

// Comprehensive Zip Code Map keyed by "PROVINCE-CITY" for accuracy
// Format: "PROVINCE NAME-CITY/MUNICIPALITY NAME" (Upper Case)
const ZIP_CODE_MAP: Record<string, string> = {
  // --- METRO MANILA ---
  'METRO MANILA-MANILA': '1000', 'METRO MANILA-CITY OF MANILA': '1000',
  'METRO MANILA-CALOOCAN': '1400', 'METRO MANILA-CITY OF CALOOCAN': '1400',
  'METRO MANILA-LAS PINAS': '1740', 'METRO MANILA-CITY OF LAS PINAS': '1740',
  'METRO MANILA-MAKATI': '1200', 'METRO MANILA-CITY OF MAKATI': '1200',
  'METRO MANILA-MALABON': '1470', 'METRO MANILA-CITY OF MALABON': '1470',
  'METRO MANILA-MANDALUYONG': '1550', 'METRO MANILA-CITY OF MANDALUYONG': '1550',
  'METRO MANILA-MARIKINA': '1800', 'METRO MANILA-CITY OF MARIKINA': '1800',
  'METRO MANILA-MUNTINLUPA': '1770', 'METRO MANILA-CITY OF MUNTINLUPA': '1770',
  'METRO MANILA-NAVOTAS': '1485', 'METRO MANILA-CITY OF NAVOTAS': '1485',
  'METRO MANILA-PARANAQUE': '1700', 'METRO MANILA-CITY OF PARANAQUE': '1700',
  'METRO MANILA-PASAY': '1300', 'METRO MANILA-CITY OF PASAY': '1300',
  'METRO MANILA-PASIG': '1600', 'METRO MANILA-CITY OF PASIG': '1600',
  'METRO MANILA-PATEROS': '1620',
  'METRO MANILA-QUEZON CITY': '1100',
  'METRO MANILA-SAN JUAN': '1500', 'METRO MANILA-CITY OF SAN JUAN': '1500',
  'METRO MANILA-TAGUIG': '1630', 'METRO MANILA-CITY OF TAGUIG': '1630',
  'METRO MANILA-VALENZUELA': '1440', 'METRO MANILA-CITY OF VALENZUELA': '1440',

  // --- ABRA ---
  'ABRA-BANGUED': '2800', 'ABRA-BOLINEY': '2815', 'ABRA-BUCAY': '2805', 'ABRA-BUCLOC': '2817',
  'ABRA-DAGUIOMAN': '2816', 'ABRA-DANGLAS': '2825', 'ABRA-DOLORES': '2801', 'ABRA-LA PAZ': '2826',
  'ABRA-LACUB': '2821', 'ABRA-LAGANGILANG': '2802', 'ABRA-LAGAYAN': '2824', 'ABRA-LANGIDEN': '2807',
  'ABRA-LICUAN-BAAY': '2819', 'ABRA-LUBA': '2813', 'ABRA-MALACOG': '2820', 'ABRA-MANABO': '2810',
  'ABRA-PENARRUBIA': '2804', 'ABRA-PIDIGAN': '2806', 'ABRA-PILAR': '2812', 'ABRA-SALLAPADAN': '2818',
  'ABRA-SAN ISIDRO': '2809', 'ABRA-SAN JUAN': '2823', 'ABRA-SAN QUINTIN': '2808', 'ABRA-TAYUM': '2803',
  'ABRA-TINEG': '2822', 'ABRA-TUBO': '2814', 'ABRA-VILLAVICIOSA': '2811',

  // --- AGUSAN DEL NORTE ---
  'AGUSAN DEL NORTE-BUTUAN': '8600', 'AGUSAN DEL NORTE-CITY OF BUTUAN': '8600',
  'AGUSAN DEL NORTE-BUENAVISTA': '8601', 'AGUSAN DEL NORTE-CABADBARAN': '8605', 
  'AGUSAN DEL NORTE-CARMEN': '8603', 'AGUSAN DEL NORTE-JABONGA': '8607', 
  'AGUSAN DEL NORTE-KITCHARAO': '8609', 'AGUSAN DEL NORTE-LAS NIEVES': '8610',
  'AGUSAN DEL NORTE-MAGALLANES': '8604', 'AGUSAN DEL NORTE-NASIPIT': '8602',
  'AGUSAN DEL NORTE-REMEDIOS T. ROMUALDEZ': '8611', 'AGUSAN DEL NORTE-SANTIAGO': '8608',
  'AGUSAN DEL NORTE-TUBAY': '8606',

  // --- AGUSAN DEL SUR ---
  'AGUSAN DEL SUR-BAYUGAN': '8502', 'AGUSAN DEL SUR-BUNAWAN': '8506', 
  'AGUSAN DEL SUR-ESPERANZA': '8513', 'AGUSAN DEL SUR-LA PAZ': '8508', 
  'AGUSAN DEL SUR-LORETO': '8507', 'AGUSAN DEL SUR-PROSPERIDAD': '8500',
  'AGUSAN DEL SUR-ROSARIO': '8504', 'AGUSAN DEL SUR-SAN FRANCISCO': '8501',
  'AGUSAN DEL SUR-SAN LUIS': '8511', 'AGUSAN DEL SUR-SANTA JOSEFA': '8512',
  'AGUSAN DEL SUR-SIBAGAT': '8503', 'AGUSAN DEL SUR-TALACOGON': '8510',
  'AGUSAN DEL SUR-TRENTO': '8505', 'AGUSAN DEL SUR-VERUELA': '8509',

  // --- AKLAN ---
  'AKLAN-ALTAVAS': '5616', 'AKLAN-BALETE': '5614', 'AKLAN-BANGA': '5601',
  'AKLAN-BATAN': '5615', 'AKLAN-BURUANGA': '5609', 'AKLAN-IBAJAY': '5613',
  'AKLAN-KALIBO': '5600', 'AKLAN-LEZO': '5605', 'AKLAN-LIBACAO': '5602',
  'AKLAN-MADALAG': '5603', 'AKLAN-MAKATO': '5611', 'AKLAN-MALAY': '5608',
  'AKLAN-MALINAO': '5606', 'AKLAN-NABAS': '5607', 'AKLAN-NEW WASHINGTON': '5610',
  'AKLAN-NUMANCIA': '5604', 'AKLAN-TANGALAN': '5612',

  // --- ALBAY ---
  'ALBAY-BACACAY': '4509', 'ALBAY-CAMALIG': '4502', 'ALBAY-DARAGA': '4501',
  'ALBAY-GUINOBATAN': '4503', 'ALBAY-JOVELLAR': '4515', 'ALBAY-LEGAZPI': '4500', 'ALBAY-CITY OF LEGAZPI': '4500',
  'ALBAY-LIBON': '4507', 'ALBAY-LIGAO': '4504', 'ALBAY-MALILIPOT': '4510',
  'ALBAY-MALINAO': '4512', 'ALBAY-MANITO': '4514', 'ALBAY-OAS': '4505',
  'ALBAY-PIO DURAN': '4516', 'ALBAY-POLANGUI': '4506', 'ALBAY-RAPU-RAPU': '4517',
  'ALBAY-SANTO DOMINGO': '4508', 'ALBAY-TABACO': '4511', 'ALBAY-TIWI': '4513',

  // --- BATAAN ---
  'BATAAN-ABUCAY': '2114', 'BATAAN-BAGAC': '2107', 'BATAAN-BALANGA': '2100',
  'BATAAN-MARIVELES': '2105', 'BATAAN-MORONG': '2108', 'BATAAN-ORANI': '2112',
  'BATAAN-ORION': '2102', 'BATAAN-PILAR': '2101', 'BATAAN-SAMAL': '2113',
  'BATAAN-HERMOSA': '2111', 'BATAAN-LIMAY': '2103', 'BATAAN-DINALUPIHAN': '2110',

  // --- BATANGAS ---
  'BATANGAS-AGONCILLO': '4211', 'BATANGAS-ALITAGTAG': '4205', 'BATANGAS-BALAYAN': '4213',
  'BATANGAS-BALETE': '4219', 'BATANGAS-BATANGAS CITY': '4200', 'BATANGAS-CITY OF BATANGAS': '4200',
  'BATANGAS-BAUAN': '4201', 'BATANGAS-CALACA': '4212', 'BATANGAS-CALATAGAN': '4215',
  'BATANGAS-CUENCA': '4222', 'BATANGAS-IBAAN': '4230', 'BATANGAS-LAUREL': '4221',
  'BATANGAS-LEMERY': '4209', 'BATANGAS-LIAN': '4216', 'BATANGAS-LIPA': '4217', 'BATANGAS-CITY OF LIPA': '4217',
  'BATANGAS-LOBO': '4229', 'BATANGAS-MABINI': '4202', 'BATANGAS-MALVAR': '4233',
  'BATANGAS-MATAASNAKAHOY': '4223', 'BATANGAS-NASUGBU': '4231', 'BATANGAS-PADRE GARCIA': '4224',
  'BATANGAS-ROSARIO': '4225', 'BATANGAS-SAN JOSE': '4227', 'BATANGAS-SAN JUAN': '4226',
  'BATANGAS-SAN LUIS': '4210', 'BATANGAS-SAN NICOLAS': '4207', 'BATANGAS-SAN PASCUAL': '4204',
  'BATANGAS-SANTA TERESITA': '4206', 'BATANGAS-STO. TOMAS': '4234', 'BATANGAS-SANTO TOMAS': '4234',
  'BATANGAS-TAAL': '4208', 'BATANGAS-TALISAY': '4220', 'BATANGAS-TANAUAN': '4232',
  'BATANGAS-TAYSAN': '4228', 'BATANGAS-TINGLOY': '4203', 'BATANGAS-TUY': '4214',

  // --- BENGUET ---
  'BENGUET-BAGUIO': '2600', 'BENGUET-CITY OF BAGUIO': '2600',
  'BENGUET-LA TRINIDAD': '2601', 'BENGUET-TUBA': '2603', 'BENGUET-ITOGON': '2604',

  // --- BULACAN ---
  'BULACAN-ANGAT': '3012', 'BULACAN-BALAGTAS': '3016', 'BULACAN-BALIUAG': '3006',
  'BULACAN-BOCAUE': '3018', 'BULACAN-BULACAN': '3017', 'BULACAN-BUSTOS': '3007',
  'BULACAN-CALUMPIT': '3003', 'BULACAN-DRT': '3009', 'BULACAN-GUIGUINTO': '3015',
  'BULACAN-HAGONOY': '3002', 'BULACAN-MALOLOS': '3000', 'BULACAN-CITY OF MALOLOS': '3000',
  'BULACAN-MARILAO': '3019', 'BULACAN-MEYCAUAYAN': '3020', 'BULACAN-CITY OF MEYCAUAYAN': '3020',
  'BULACAN-NORZAGARAY': '3013', 'BULACAN-OBANDO': '3021', 'BULACAN-PANDI': '3014',
  'BULACAN-PAOMBONG': '3001', 'BULACAN-PLARIDEL': '3004', 'BULACAN-PULILAN': '3005',
  'BULACAN-SAN ILDEFONSO': '3010', 'BULACAN-SAN JOSE DEL MONTE': '3023', 'BULACAN-CITY OF SAN JOSE DEL MONTE': '3023',
  'BULACAN-SAN MIGUEL': '3011', 'BULACAN-SAN RAFAEL': '3008', 'BULACAN-SANTA MARIA': '3022',

  // --- CAVITE ---
  'CAVITE-ALFONSO': '4123', 'CAVITE-AMADEO': '4119', 'CAVITE-BACOOR': '4102', 'CAVITE-CITY OF BACOOR': '4102',
  'CAVITE-CARMONA': '4116', 'CAVITE-CAVITE CITY': '4100', 'CAVITE-CITY OF CAVITE': '4100',
  'CAVITE-DASMARINAS': '4114', 'CAVITE-CITY OF DASMARINAS': '4114',
  'CAVITE-GENERAL EMILIO AGUINALDO': '4124', 'CAVITE-GENERAL MARIANO ALVAREZ': '4117',
  'CAVITE-GENERAL TRIAS': '4107', 'CAVITE-CITY OF GENERAL TRIAS': '4107',
  'CAVITE-IMUS': '4103', 'CAVITE-CITY OF IMUS': '4103',
  'CAVITE-INDANG': '4122', 'CAVITE-KAWIT': '4104', 'CAVITE-MAGALLANES': '4113',
  'CAVITE-MARAGONDON': '4112', 'CAVITE-MENDEZ': '4121', 'CAVITE-NAIC': '4110',
  'CAVITE-NOVELETA': '4105', 'CAVITE-ROSARIO': '4106', 'CAVITE-SILANG': '4118',
  'CAVITE-TAGAYTAY': '4120', 'CAVITE-CITY OF TAGAYTAY': '4120',
  'CAVITE-TANZA': '4108', 'CAVITE-TERNATE': '4111',
  'CAVITE-TRECE MARTIRES': '4109', 'CAVITE-CITY OF TRECE MARTIRES': '4109',

  // --- CEBU ---
  'CEBU-ALCANTARA': '6033', 'CEBU-ALCOY': '6023', 'CEBU-ALEGRIA': '6030',
  'CEBU-ALOGUINSAN': '6040', 'CEBU-ARGAO': '6021', 'CEBU-ASTURIAS': '6042',
  'CEBU-BADIAN': '6031', 'CEBU-BALAMBAN': '6041', 'CEBU-BANTAYAN': '6052',
  'CEBU-BARILI': '6036', 'CEBU-BOGO': '6010', 'CEBU-BOLJOON': '6024',
  'CEBU-BORBON': '6008', 'CEBU-CARCAR': '6019', 'CEBU-CARMEN': '6005',
  'CEBU-CATMON': '6006', 'CEBU-CEBU CITY': '6000', 'CEBU-CITY OF CEBU': '6000',
  'CEBU-COMPOSTELA': '6003', 'CEBU-CONSOLACION': '6001', 'CEBU-CORDOVA': '6017',
  'CEBU-DAANBANTAYAN': '6013', 'CEBU-DALAGUETE': '6022', 'CEBU-DANAO': '6004',
  'CEBU-DUMANJUG': '6035', 'CEBU-GINATILAN': '6028', 'CEBU-LAPU-LAPU': '6015', 'CEBU-CITY OF LAPU-LAPU': '6015',
  'CEBU-LILOAN': '6002', 'CEBU-MADRIDEJOS': '6053', 'CEBU-MALABUYOC': '6029',
  'CEBU-MANDAUE': '6014', 'CEBU-CITY OF MANDAUE': '6014', 'CEBU-MEDELLIN': '6012',
  'CEBU-MINGLANILLA': '6046', 'CEBU-MOALBOAL': '6032', 'CEBU-NAGA': '6037',
  'CEBU-OSLOB': '6025', 'CEBU-PILAR': '6048', 'CEBU-PINAMUNGAJAN': '6039',
  'CEBU-PORO': '6049', 'CEBU-RONDA': '6034', 'CEBU-SAMBOAN': '6027',
  'CEBU-SAN FERNANDO': '6018', 'CEBU-SAN FRANCISCO': '6050', 'CEBU-SAN REMIGIO': '6011',
  'CEBU-SANTA FE': '6047', 'CEBU-SANTANDER': '6026', 'CEBU-SIBONGA': '6020',
  'CEBU-SOGOD': '6007', 'CEBU-TABOGON': '6009', 'CEBU-TABUELAN': '6044',
  'CEBU-TALISAY': '6045', 'CEBU-CITY OF TALISAY': '6045', 'CEBU-TOLEDO': '6038',
  'CEBU-TUBURAN': '6043', 'CEBU-TUDELA': '6051',

  // --- DAVAO DEL SUR ---
  'DAVAO DEL SUR-DAVAO CITY': '8000', 'DAVAO DEL SUR-CITY OF DAVAO': '8000',
  'DAVAO DEL SUR-DIGOS': '8002', 'DAVAO DEL SUR-CITY OF DIGOS': '8002',
  'DAVAO DEL SUR-BANSALAN': '8005', 'DAVAO DEL SUR-HAGONOY': '8006',
  'DAVAO DEL SUR-KIBLAWAN': '8008', 'DAVAO DEL SUR-MAGSAYSAY': '8004',
  'DAVAO DEL SUR-MALALAG': '8010', 'DAVAO DEL SUR-MATANAO': '8003',
  'DAVAO DEL SUR-PADADA': '8007', 'DAVAO DEL SUR-SANTA CRUZ': '8001',
  'DAVAO DEL SUR-SULOP': '8009',

  // --- DAVAO DEL NORTE ---
  'DAVAO DEL NORTE-TAGUM': '8100', 'DAVAO DEL NORTE-CITY OF TAGUM': '8100',
  'DAVAO DEL NORTE-PANABO': '8105', 'DAVAO DEL NORTE-CITY OF PANABO': '8105',
  'DAVAO DEL NORTE-ISLAND GARDEN CITY OF SAMAL': '8119', 'DAVAO DEL NORTE-SAMAL': '8119',
  'DAVAO DEL NORTE-ASUNCION': '8102', 'DAVAO DEL NORTE-BRAULIO E. DUJALI': '8106',
  'DAVAO DEL NORTE-CARMEN': '8101', 'DAVAO DEL NORTE-KAPALONG': '8113',
  'DAVAO DEL NORTE-NEW CORELLA': '8104', 'DAVAO DEL NORTE-SAN ISIDRO': '8109',
  'DAVAO DEL NORTE-SANTO TOMAS': '8112', 'DAVAO DEL NORTE-TALAINGOD': '8114',

  // --- LAGUNA ---
  'LAGUNA-ALAMINOS': '4001', 'LAGUNA-BAY': '4033', 'LAGUNA-BINAN': '4024', 'LAGUNA-CITY OF BINAN': '4024',
  'LAGUNA-CABUYAO': '4025', 'LAGUNA-CITY OF CABUYAO': '4025',
  'LAGUNA-CALAMBA': '4027', 'LAGUNA-CITY OF CALAMBA': '4027',
  'LAGUNA-CALAUAN': '4012', 'LAGUNA-CAVINTI': '4013', 'LAGUNA-FAMY': '4021',
  'LAGUNA-KALAYAAN': '4015', 'LAGUNA-LILIW': '4004', 'LAGUNA-LOS BANOS': '4030',
  'LAGUNA-LUISIANA': '4032', 'LAGUNA-LUMBAN': '4014', 'LAGUNA-MABITAC': '4020',
  'LAGUNA-MAGDALENA': '4007', 'LAGUNA-MAJAYJAY': '4005', 'LAGUNA-NAGCARLAN': '4002',
  'LAGUNA-PAETE': '4016', 'LAGUNA-PAGSANJAN': '4008', 'LAGUNA-PAKIL': '4017',
  'LAGUNA-PANGIL': '4018', 'LAGUNA-PILA': '4010', 'LAGUNA-RIZAL': '4003',
  'LAGUNA-SAN PABLO': '4000', 'LAGUNA-CITY OF SAN PABLO': '4000',
  'LAGUNA-SAN PEDRO': '4023', 'LAGUNA-CITY OF SAN PEDRO': '4023',
  'LAGUNA-SANTA CRUZ': '4009', 'LAGUNA-SANTA MARIA': '4022',
  'LAGUNA-SANTA ROSA': '4026', 'LAGUNA-CITY OF SANTA ROSA': '4026',
  'LAGUNA-SINILOAN': '4019', 'LAGUNA-VICTORIA': '4011',

  // --- PAMPANGA ---
  'PAMPANGA-ANGELES': '2009', 'PAMPANGA-CITY OF ANGELES': '2009',
  'PAMPANGA-APALIT': '2016', 'PAMPANGA-ARAYAT': '2012', 'PAMPANGA-BACOLOR': '2001',
  'PAMPANGA-CANDABA': '2013', 'PAMPANGA-FLORIDABLANCA': '2006', 'PAMPANGA-GUAGUA': '2003',
  'PAMPANGA-LUBATA': '2005', 'PAMPANGA-MABALACAT': '2010', 'PAMPANGA-CITY OF MABALACAT': '2010',
  'PAMPANGA-MACABEBE': '2018', 'PAMPANGA-MAGALANG': '2011', 'PAMPANGA-MASANTOL': '2017',
  'PAMPANGA-MEXICO': '2021', 'PAMPANGA-MINALIN': '2019', 'PAMPANGA-PORAC': '2008',
  'PAMPANGA-SAN FERNANDO': '2000', 'PAMPANGA-CITY OF SAN FERNANDO': '2000',
  'PAMPANGA-SAN LUIS': '2014', 'PAMPANGA-SAN SIMON': '2015', 'PAMPANGA-SANTA ANA': '2022',
  'PAMPANGA-SANTA RITA': '2002', 'PAMPANGA-SANTO TOMAS': '2020', 'PAMPANGA-SASMUAN': '2004',

  // --- RIZAL ---
  'RIZAL-ANGONO': '1930', 'RIZAL-ANTIPOLO': '1870', 'RIZAL-CITY OF ANTIPOLO': '1870',
  'RIZAL-BARAS': '1970', 'RIZAL-BINANGONAN': '1940', 'RIZAL-CAINTA': '1900',
  'RIZAL-CARDONA': '1950', 'RIZAL-JALA-JALA': '1990', 'RIZAL-MORONG': '1960',
  'RIZAL-PILILLA': '1910', 'RIZAL-RODRIGUEZ': '1860', 'RIZAL-MONTALBAN': '1860',
  'RIZAL-SAN MATEO': '1850', 'RIZAL-TANAY': '1980', 'RIZAL-TAYTAY': '1920',
  'RIZAL-TERESA': '1880',

  // --- SOUTH COTABATO ---
  'SOUTH COTABATO-GENERAL SANTOS': '9500', 'SOUTH COTABATO-CITY OF GENERAL SANTOS': '9500',
  'SOUTH COTABATO-KORONADAL': '9506', 'SOUTH COTABATO-POLOMOLOK': '9504',
  'SOUTH COTABATO-TUPI': '9505',
};

// Fallback Zip Codes by Province (Capital or General)
const PROVINCE_ZIP_FALLBACK: Record<string, string> = {
  'ABRA': '2800', 'AGUSAN DEL NORTE': '8600', 'AGUSAN DEL SUR': '8500', 'AKLAN': '5600',
  'ALBAY': '4500', 'ANTIQUE': '5700', 'APAYAO': '3800', 'AURORA': '3200', 'BASILAN': '7300',
  'BATAAN': '2100', 'BATANES': '3900', 'BATANGAS': '4200', 'BENGUET': '2600', 'BILIRAN': '6560',
  'BOHOL': '6300', 'BUKIDNON': '8700', 'BULACAN': '3000', 'CAGAYAN': '3500',
  'CAMARINES NORTE': '4600', 'CAMARINES SUR': '4400', 'CAMIGUIN': '9100', 'CAPIZ': '5800',
  'CATANDUANES': '4800', 'CAVITE': '4100', 'CEBU': '6000', 'COMPOSTELA VALLEY': '8800',
  'COTABATO': '9400', 'DAVAO DEL NORTE': '8100', 'DAVAO DEL SUR': '8000', 'DAVAO ORIENTAL': '8200',
  'DINAGAT ISLANDS': '8427', 'EASTERN SAMAR': '6800', 'GUIMARAS': '5044', 'IFUGAO': '3600',
  'ILOCOS NORTE': '2900', 'ILOCOS SUR': '2700', 'ILOILO': '5000', 'ISABELA': '3300',
  'KALINGA': '3800', 'LA UNION': '2500', 'LAGUNA': '4000', 'LANAO DEL NORTE': '9200',
  'LANAO DEL SUR': '9700', 'LEYTE': '6500', 'MAGUINDANAO': '9600', 'MARINDUQUE': '4900',
  'MASBATE': '5400', 'MISAMIS OCCIDENTAL': '7200', 'MISAMIS ORIENTAL': '9000',
  'MOUNTAIN PROVINCE': '2620', 'NEGROS OCCIDENTAL': '6100', 'NEGROS ORIENTAL': '6200',
  'NORTHERN SAMAR': '6400', 'NUEVA ECIJA': '3100', 'NUEVA VIZCAYA': '3700',
  'OCCIDENTAL MINDORO': '5100', 'ORIENTAL MINDORO': '5200', 'PALAWAN': '5300',
  'PAMPANGA': '2000', 'PANGASINAN': '2400', 'QUEZON': '4300', 'QUIRINO': '3400',
  'RIZAL': '1850', 'ROMBLON': '5500', 'SAMAR': '6700', 'SARANGANI': '8015',
  'SIQUIJOR': '6225', 'SORSOGON': '4700', 'SOUTH COTABATO': '9500', 'SOUTHERN LEYTE': '6600',
  'SULTAN KUDARAT': '9800', 'SULU': '7400', 'SURIGAO DEL NORTE': '8400',
  'SURIGAO DEL SUR': '8300', 'TARLAC': '2300', 'TAWI-TAWI': '7500', 'ZAMBALES': '2200',
  'ZAMBOANGA DEL NORTE': '7100', 'ZAMBOANGA DEL SUR': '7000', 'ZAMBOANGA SIBUGAY': '7001',
  'METRO MANILA': '1000',
};

export const LocationService = {
  getProvinces: async (): Promise<LocationOption[]> => {
    try {
      const response = await fetch(`${BASE_URL}/province.json`);
      if (!response.ok) throw new Error('Failed to fetch provinces');
      const data = await response.json();
      return data.map((item: any) => ({
        code: item.province_code,
        name: item.province_name
      })).sort((a: LocationOption, b: LocationOption) => a.name.localeCompare(b.name));
    } catch (error) {
      console.error('Error fetching provinces:', error);
      return [];
    }
  },

  getCities: async (provinceCode: string): Promise<LocationOption[]> => {
    try {
      const response = await fetch(`${BASE_URL}/city.json`);
      if (!response.ok) throw new Error('Failed to fetch cities');
      const data = await response.json();
      return data
        .filter((item: any) => item.province_code === provinceCode)
        .map((item: any) => ({
          code: item.city_code,
          name: item.city_name
        })).sort((a: LocationOption, b: LocationOption) => a.name.localeCompare(b.name));
    } catch (error) {
      console.error('Error fetching cities:', error);
      return [];
    }
  },

  getBarangays: async (cityCode: string): Promise<LocationOption[]> => {
    try {
      const response = await fetch(`${BASE_URL}/barangay.json`);
      if (!response.ok) throw new Error('Failed to fetch barangays');
      const data = await response.json();
      return data
        .filter((item: any) => item.city_code === cityCode)
        .map((item: any) => ({
          code: item.brgy_code,
          name: item.brgy_name
        })).sort((a: LocationOption, b: LocationOption) => a.name.localeCompare(b.name));
    } catch (error) {
      console.error('Error fetching barangays:', error);
      return [];
    }
  },

  getZipCode: (cityName: string, provinceName: string): string => {
    if (!cityName || !provinceName) return '';

    const cityUpper = cityName.toUpperCase().trim();
    const provinceUpper = provinceName.toUpperCase().trim();

    // 1. Primary Lookup: PROVINCE-CITY Key
    // This resolves duplicates (e.g., San Jose, Batangas vs San Jose, Nueva Ecija)
    const exactKey = `${provinceUpper}-${cityUpper}`;
    if (ZIP_CODE_MAP[exactKey]) {
      return ZIP_CODE_MAP[exactKey];
    }
    
    // 1.b Fuzzy Lookup: Try stripping "CITY OF" / "MUNICIPALITY OF" from key
    const simpleCity = cityUpper.replace(/^(CITY OF |MUNICIPALITY OF )/, '').trim();
    const simpleKey = `${provinceUpper}-${simpleCity}`;
    if (ZIP_CODE_MAP[simpleKey]) {
      return ZIP_CODE_MAP[simpleKey];
    }

    // 2. Province Fallback
    if (PROVINCE_ZIP_FALLBACK[provinceUpper]) {
      return PROVINCE_ZIP_FALLBACK[provinceUpper];
    }

    // 3. Default
    return '';
  }
};
